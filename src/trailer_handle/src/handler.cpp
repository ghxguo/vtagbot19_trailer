/** \file
* this is the highlevel control code for the trailer
* developed by: Hongxu Guo
* Date: 5-1-19
*
* version: 1.0
*/


#include <ros/ros.h>
#include <std_msgs/String.h>
#include <sstream>
#include <std_msgs/MultiArrayDimension.h>
#include <std_msgs/UInt16MultiArray.h>
#include <std_msgs/UInt8.h>
#include <std_msgs/UInt16.h>
#include <std_msgs/Char.h>
#include <std_msgs/Bool.h>
#include <vector>

#define PROFILE1LENGTH  215
#define PROFILE2LENGTH  246
#define PROFILE3LENGTH  510
// #define PROFILE4LENGTH  100
#define MOTIONTH        30
#define GRIPOPEN        80

uint16_t profile1[]
{
523,512,137,403,278,2861,
522,511,141,399,289,2862,
522,511,149,398,297,2873,
522,511,160,397,308,2880,
522,511,166,394,319,2883,
522,511,175,391,331,2882,
522,511,182,385,343,2881,
522,511,189,380,355,2879,
522,511,199,377,368,2880,
522,511,210,373,384,2886,
522,511,221,368,397,2893,
522,511,231,366,409,2900,
522,511,243,366,420,2906,
522,511,257,366,431,2912,
522,511,272,366,445,2919,
522,511,287,366,456,2930,
522,511,302,366,473,2943,
522,511,317,366,486,2954,
522,511,333,366,501,2967,
522,511,347,366,516,2979,
522,511,363,366,530,2992,
523,511,379,366,543,3008,
522,511,393,366,556,3030,
522,511,408,366,572,3051,
522,511,422,366,585,3072,
522,511,436,366,596,3104,
522,511,446,366,604,3143,
522,511,453,366,610,3178,
522,511,458,366,616,3213,
522,511,462,366,620,3244,
522,511,466,366,622,3276,
522,511,468,366,627,3307,
522,511,468,366,629,3338,
522,511,470,366,630,3369,
522,511,472,366,631,3402,
522,511,472,366,631,3432,
522,511,474,366,631,3460,
522,511,477,366,633,3489,
522,511,480,366,633,3517,
522,511,483,366,638,3543,
522,511,487,366,641,3567,
522,511,492,366,644,3591,
522,511,499,366,650,3615,
522,511,506,366,652,3632,
522,511,512,366,659,3647,
522,511,519,366,663,3660,
522,512,530,366,671,3659,
522,512,538,366,675,3670,
522,513,539,361,675,3681,
522,512,535,349,676,3685,
522,512,523,340,676,3684,
523,512,512,333,676,3681,
522,512,498,327,676,3675,
522,511,485,320,676,3669,
522,511,474,312,676,3662,
522,511,468,303,676,3651,
522,511,457,293,674,3650,
522,511,446,291,666,3650,
522,511,435,287,659,3650,
522,511,423,286,655,3650,
522,511,412,283,649,3648,
522,511,401,282,641,3643,
522,511,394,282,630,3642,
522,511,385,279,619,3642,
522,511,374,277,616,3639,
522,511,363,275,610,3639,
522,511,352,273,601,3642,
522,511,341,270,593,3645,
522,510,332,267,582,3644,
522,510,321,265,572,3644,
522,509,310,264,565,3644,
522,508,299,264,555,3646,
522,508,293,263,544,3644,
323,508,293,263,544,3644,
325,507,271,256,540,3647,
324,507,283,257,550,3647,
324,507,293,257,563,3647,
324,507,304,261,573,3647,
324,507,318,263,584,3649,
324,507,333,265,594,3651,
324,507,350,270,604,3652,
324,507,368,275,612,3654,
324,507,386,281,622,3655,
324,507,404,286,638,3656,
324,507,422,293,650,3656,
324,507,442,303,659,3656,
324,507,458,313,666,3656,
324,507,474,324,674,3656,
324,507,489,332,678,3655,
324,507,500,341,680,3655,
324,507,511,353,680,3657,
324,508,519,365,680,3660,
324,508,525,377,680,3661,
324,508,533,389,680,3663,
324,508,543,403,680,3667,
324,508,555,411,680,3669,
324,508,566,421,678,3664,
324,508,572,432,676,3665,
324,508,577,443,672,3666,
324,508,585,455,671,3667,
324,508,596,467,669,3667,
324,508,604,478,666,3668,
324,508,617,488,662,3667,
324,508,621,500,659,3666,
324,509,627,512,656,3665,
324,509,633,523,650,3665,
324,509,637,534,649,3664,
324,510,643,545,646,3664,
325,510,652,557,639,3667,
324,511,660,568,631,3669,
324,511,667,579,628,3669,
324,511,674,590,622,3667,
324,511,680,602,617,3665,
324,511,685,613,612,3665,
324,511,694,624,609,3663,
324,512,701,635,605,3662,
324,512,708,647,601,3662,
324,512,713,660,597,3662,
324,513,718,671,593,3661,
324,513,721,683,587,3657,
324,514,725,695,582,3654,
324,515,729,706,577,3652,
324,517,737,717,572,3650,
324,518,748,725,569,3650,
324,519,759,727,569,3652,
324,519,760,727,568,3663,
324,519,760,727,568,1434,
324,521,771,729,562,1385,
324,522,764,729,551,1382,
324,522,755,731,540,1381,
324,524,750,731,529,1385,
324,525,738,731,522,1385,
324,525,729,731,511,1385,
324,526,718,731,500,1389,
324,528,712,731,491,1400,
324,530,701,731,481,1406,
324,530,697,734,470,1403,
324,533,697,739,459,1404,
324,534,697,748,447,1413,
324,534,692,751,436,1420,
324,534,684,751,425,1425,
324,534,672,751,418,1426,
324,535,672,759,406,1426,
324,535,672,772,398,1420,
324,535,672,779,387,1411,
324,535,672,790,377,1404,
324,535,672,801,367,1400,
324,535,672,813,358,1398,
324,534,672,824,350,1397,
324,534,672,835,343,1394,
324,534,672,846,335,1393,
324,534,672,857,326,1386,
324,534,672,866,315,1382,
324,534,672,877,306,1379,
324,534,672,888,300,1373,
324,534,672,899,290,1366,
324,534,672,910,281,1357,
324,534,672,921,270,1350,
324,534,672,932,261,1347,
324,534,672,943,251,1340,
324,534,672,944,240,1331,
324,534,672,944,230,1320,
324,534,672,943,223,1309,
324,534,672,943,215,1298,
324,534,672,943,210,1287,
324,534,672,943,210,1276,
324,534,661,943,210,1273,
324,533,644,942,209,1273,
324,533,629,940,205,1271,
324,532,616,938,201,1267,
324,531,602,933,198,1265,
324,531,591,924,198,1262,
324,532,585,913,198,1258,
324,533,574,907,198,1255,
324,532,563,903,198,1254,
324,532,552,899,197,1248,
324,532,541,892,197,1242,
325,532,530,885,197,1236,
324,532,519,878,197,1233,
324,531,508,869,197,1228,
324,531,496,859,197,1223,
324,531,485,847,197,1217,
324,531,477,836,197,1212,
324,531,467,825,200,1207,
324,531,457,814,203,1202,
324,531,449,803,204,1199,
324,532,442,792,206,1194,
324,532,432,780,211,1189,
324,533,423,768,213,1184,
324,533,413,754,217,1180,
324,533,406,743,220,1176,
324,534,401,732,223,1172,
324,533,396,721,226,1167,
324,533,391,710,231,1161,
324,533,388,698,235,1155,
325,533,383,687,240,1151,
324,533,375,676,244,1145,
324,533,367,664,250,1139,
324,533,359,652,253,1136,
324,532,351,640,256,1132,
324,532,345,628,263,1126,
324,532,343,617,271,1119,
324,533,340,606,278,1109,
324,532,339,601,279,1098,
324,532,336,593,281,1087,
324,532,341,587,288,1076,
324,533,350,582,289,1065,
324,532,352,582,290,1054,
324,531,351,572,298,1043,
324,531,347,561,303,1042,
325,531,357,555,312,1031,
324,531,362,555,315,1020,
324,531,363,555,326,1015,
335,531,350,573,340,1002,
};
uint16_t profile2[]=
{
  324,530,374,549,336,1030,
324,531,370,549,326,1041,
324,531,360,549,319,1052,
324,531,357,549,314,1063,
324,531,352,549,311,1074,
324,531,347,549,310,1085,
324,531,347,549,310,1096,
324,531,347,549,310,1107,
324,531,343,549,310,1118,
324,531,334,549,309,1129,
324,531,327,549,309,1140,
324,531,339,549,309,1149,
324,531,340,549,309,1160,
324,531,340,549,310,1171,
324,531,341,549,313,1182,
324,531,341,549,318,1193,
324,531,343,549,319,1204,
324,531,349,549,323,1215,
324,531,356,549,328,1226,
324,530,360,549,334,1237,
325,531,363,549,335,1248,
324,531,370,549,339,1259,
324,531,373,549,343,1270,
324,530,377,549,345,1281,
325,530,379,549,347,1292,
324,530,381,549,348,1303,
324,530,388,549,354,1314,
324,530,401,549,359,1323,
324,530,412,549,369,1334,
324,530,424,549,377,1344,
324,530,435,549,384,1354,
324,531,444,549,389,1366,
324,530,449,549,400,1372,
324,530,460,549,408,1376,
324,530,471,549,412,1380,
324,530,482,549,419,1384,
324,531,493,549,427,1383,
324,531,504,549,432,1379,
324,531,515,549,439,1379,
324,531,526,549,449,1385,
324,531,537,549,454,1384,
324,531,547,549,465,1380,
324,530,551,549,476,1371,
324,530,562,549,483,1375,
324,530,570,549,488,1386,
324,530,581,549,497,1391,
324,530,584,549,508,1394,
324,530,591,549,519,1400,
324,530,597,549,530,1404,
324,530,601,549,541,1402,
324,529,611,549,552,1408,
324,529,622,549,561,1414,
324,529,627,549,572,1421,
324,529,630,549,583,1419,
324,529,630,549,594,1419,
324,529,629,549,605,1414,
324,529,629,549,610,1403,
324,529,631,549,616,1392,
324,530,642,549,622,1393,
324,530,649,549,631,1404,
324,530,650,549,635,1415,
325,530,652,549,639,1427,
324,530,654,549,641,1438,
324,530,656,549,641,1450,
324,530,656,549,641,1461,
324,530,656,549,641,1473,
324,530,656,549,642,1486,
324,531,656,549,643,1502,
324,530,656,549,645,1520,
324,530,656,549,645,1539,
324,530,656,549,645,1564,
324,530,656,549,645,1590,
324,530,656,549,645,1614,
324,530,656,549,645,1635,
324,530,656,549,645,1652,
324,530,656,549,645,1667,
324,530,656,549,645,1680,
325,531,656,549,645,1692,
324,530,656,549,645,1708,
324,530,656,549,645,1728,
324,530,656,549,645,1752,
324,530,656,549,645,1780,
324,530,656,549,645,1806,
324,530,656,549,645,1829,
324,530,656,549,645,1852,
324,530,656,549,645,1871,
324,530,656,549,645,1891,
324,530,656,549,645,1910,
324,530,656,549,644,1925,
325,530,656,549,644,1937,
324,530,656,549,644,1948,
324,530,656,549,644,1959,
325,530,656,549,644,1973,
324,530,656,549,644,1988,
324,530,656,549,644,2000,
324,530,656,549,645,2011,
324,530,656,550,646,2022,
324,530,656,552,646,2033,
324,530,656,554,646,2044,
324,530,659,555,646,2055,
324,530,662,557,646,2069,
324,530,664,560,646,2083,
324,530,672,561,646,2095,
324,530,677,561,646,2107,
324,530,684,561,646,2118,
324,530,685,561,646,2129,
324,530,689,563,646,2141,
324,530,689,563,646,2152,
324,530,689,567,641,2164,
324,530,689,570,639,2176,
324,530,689,577,631,2187,
324,530,691,582,622,2198,
324,530,691,587,619,2209,
324,530,689,594,614,2220,
324,532,689,596,611,2231,
325,533,689,596,610,2242,
324,533,689,596,609,2254,
324,533,688,597,606,2265,
324,533,685,603,602,2276,
324,534,685,611,596,2287,
324,534,692,619,589,2298,
324,534,694,621,584,2309,
324,534,694,621,579,2320,
324,534,691,610,573,2328,
324,534,692,599,573,2327,
324,534,692,588,575,2321,
324,534,692,577,580,2322,
324,534,692,566,584,2321,
324,534,692,557,586,2320,
324,534,692,544,590,2321,
324,534,635,533,597,2320,
324,534,628,522,601,2319,
325,534,621,511,602,2322,
325,534,616,500,602,2328,
324,534,616,489,603,2322,
324,534,605,483,603,2324,
324,534,594,479,603,2327,
324,534,586,468,611,2327,
325,534,581,457,617,2320,
324,534,571,446,618,2320,
324,534,563,435,622,2320,
324,534,552,425,626,2320,
324,534,541,417,630,2320,
324,534,535,406,634,2321,
324,534,524,397,634,2326,
324,534,513,391,634,2326,
324,534,503,380,633,2323,
324,534,492,375,633,2323,
324,534,483,363,633,2319,
324,532,474,352,629,2321,
324,532,463,348,629,2321,
324,532,452,342,629,2321,
324,531,441,339,629,2322,
324,531,452,340,629,2317,
324,531,463,345,629,2318,
511,518,437,340,617,2360,
511,518,426,340,621,2360,
511,518,415,340,621,2364,
511,518,404,340,621,2363,
511,519,393,340,621,2362,
511,518,389,351,621,2358,
511,518,400,360,620,2361,
511,518,411,369,620,2360,
511,518,422,378,620,2358,
511,518,435,385,619,2355,
511,518,448,395,618,2350,
511,518,455,406,611,2345,
511,518,455,415,600,2346,
511,518,466,415,592,2348,
512,519,460,404,592,2353,
512,520,449,394,592,2355,
511,520,438,391,589,2353,
512,520,427,390,580,2352,
512,520,418,390,569,2356,
512,519,406,388,565,2358,
511,518,434,387,579,2332,
512,518,445,387,580,2334,
512,517,456,389,591,2333,
512,517,458,391,602,2326,
512,517,467,395,613,2329,
512,517,477,395,622,2340,
512,517,485,395,629,2352,
511,517,493,395,631,2365,
512,517,503,395,638,2380,
512,517,511,395,641,2394,
512,516,517,395,646,2410,
512,517,520,395,650,2428,
512,517,523,395,651,2445,
512,517,524,395,655,2464,
512,517,524,395,656,2485,
512,517,525,395,659,2509,
511,517,525,395,661,2534,
512,518,525,395,661,2560,
512,518,525,395,661,2587,
512,518,527,395,661,2617,
512,518,530,395,661,2649,
512,518,531,395,661,2685,
512,518,536,395,661,2716,
512,518,539,395,661,2744,
512,518,541,395,661,2772,
512,518,545,394,661,2797,
512,519,546,394,661,2818,
512,519,547,391,661,2839,
512,519,547,390,661,2861,
512,520,547,387,661,2879,
512,520,542,384,661,2893,
512,521,537,378,659,2904,
512,522,529,374,656,2915,
512,524,518,366,651,2922,
512,525,506,359,649,2923,
512,526,494,354,646,2922,
511,526,483,349,641,2920,
512,527,472,345,633,2917,
512,527,460,339,629,2916,
512,528,448,333,621,2913,
512,528,437,331,616,2907,
512,528,426,330,610,2903,
512,528,413,327,602,2898,
512,528,401,326,593,2894,
512,528,391,326,581,2891,
512,528,380,326,569,2883,
512,528,368,326,556,2878,
512,528,356,326,544,2875,
512,528,343,326,535,2871,
512,528,332,326,524,2868,
511,528,322,326,511,2868,
511,527,312,326,500,2867,
512,527,301,326,490,2866,
512,527,293,326,479,2862,
512,527,282,326,468,2857,
512,527,271,327,455,2855,
512,527,260,327,443,2854,
511,526,247,328,434,2853,
512,526,236,331,423,2854,
512,527,223,332,410,2851,
512,526,212,338,397,2848,
512,526,203,342,385,2846,
512,526,194,349,371,2844,
512,526,186,359,359,2841,
512,527,177,370,350,2838,
512,527,173,377,339,2836,
512,527,169,388,328,2833,
512,528,168,398,315,2833,
511,529,165,404,303,2836,
512,530,163,411,293,2847,
512,530,152,414,286,2849,
};
// uint16_t profile3[]=
// {
// 498,515,141,411,281,2879,
// 498,513,141,411,281,2867,
// 498,513,142,403,292,2861,
// 498,513,142,391,301,2857,
// 499,513,144,380,312,2853,
// 498,513,144,374,323,2850,
// 498,513,147,366,334,2850,
// 498,513,153,359,346,2854,
// 498,513,163,358,358,2865,
// 498,514,172,358,364,2876,
// 498,513,183,358,373,2885,
// 498,513,192,358,384,2890,
// 498,513,203,358,394,2893,
// 498,513,214,358,405,2897,
// 498,513,225,358,414,2899,
// 498,512,239,358,424,2902,
// 498,512,250,358,434,2905,
// 498,511,263,358,445,2910,
// 498,511,274,358,454,2914,
// 498,511,285,358,465,2918,
// 498,511,296,358,474,2924,
// 498,510,308,358,484,2930,
// 498,510,320,358,494,2936,
// 498,510,331,358,502,2943,
// 498,510,337,358,514,2948,
// 498,509,349,358,523,2957,
// 498,509,360,358,530,2966,
// 498,508,368,358,536,2978,
// 498,508,377,359,543,2989,
// 498,508,385,359,547,3000,
// 499,507,389,361,551,3013,
// 498,507,396,363,554,3025,
// 498,507,400,365,555,3036,
// 498,507,401,367,555,3048,
// 498,506,401,368,555,3060,
// 498,506,401,370,555,3071,
// 498,506,401,373,555,3082,
// 498,505,401,373,555,3093,
// 498,505,401,373,555,3104,
// 499,504,402,373,555,3115,
// 498,504,403,373,555,3126,
// 498,504,403,373,555,3137,
// 499,503,403,373,553,3148,
// 498,503,391,373,544,3159,
// 498,503,380,373,539,3162,
// 498,502,375,381,528,3168,
// 498,502,375,394,518,3169,
// 498,503,377,397,507,3172,
// 499,503,370,405,496,3176,
// 498,503,372,416,490,3187,
// 498,503,377,424,483,3198,
// 498,503,377,435,473,3205,
// 498,503,375,443,462,3209,
// 498,503,375,453,451,3214,
// 498,503,375,462,440,3215,
// 498,504,370,467,429,3209,
// 498,505,359,462,424,3209,
// 499,505,348,461,422,3210,
// 499,508,366,473,419,3215,//gripper 79, 510, 360, 466, 418, 3220
// 11,508,366,473,419,3215,//gripper
// 11,513,354,468,417,3218,
// 11,512,365,468,410,3220,
// 11,512,363,468,400,3209,
// 11,512,366,470,380,3204,
// 11,513,382,468,380,3204,
// 11,515,404,468,380,3205,
// 11,516,425,468,380,3206,
// 11,516,443,468,469,3207,
// 11,516,451,468,480,3209,
// 11,515,453,465,491,3209,
// 11,514,462,465,502,3208,
// 11,514,472,465,513,3210,
// 11,514,480,467,524,3210,
// 11,514,491,472,532,3210,
// 11,514,498,483,532,3203,
// 11,514,509,493,533,3206,
// 11,514,513,504,533,3206,
// 11,513,519,516,533,3203,
// 11,514,530,525,533,3202,
// 11,514,541,535,533,3200,
// 11,514,554,546,533,3198,
// 11,514,566,559,533,3198,
// 11,514,578,569,533,3198,
// 11,514,588,580,533,3198,
// 11,514,599,591,533,3198,
// 11,514,609,603,533,3199,
// 11,514,621,613,533,3198,
// 11,513,631,624,533,3199,
// 11,513,641,635,533,3197,
// 11,513,652,644,533,3196,
// 11,513,663,654,533,3196,
// 11,513,674,663,533,3195,
// 11,512,685,673,533,3197,
// 11,513,694,684,533,3192,
// 11,513,695,695,532,3182,
// 11,513,695,705,532,3171,
// 11,513,707,709,532,3181,
// 11,514,718,713,532,3183,
// 11,514,726,723,532,3172,
// 11,513,727,731,532,3161,
// 11,515,734,735,532,3150,
// 11,516,738,737,532,3139,
// 11,517,739,739,532,3128,
// 11,517,734,739,532,3117,
// 11,517,729,739,532,3106,
// 11,516,728,739,532,3095,
// 11,516,727,739,532,3083,
// 11,516,727,739,532,3072,
// 11,516,727,739,532,3061,
// 11,516,727,739,532,3050,
// 11,516,727,739,532,3039,
// 11,516,727,739,532,3028,
// 11,516,727,739,532,3017,
// 11,516,727,739,532,3005,
// 11,516,727,739,532,2992,
// 11,516,727,739,532,2979,
// 11,516,727,739,532,2968,
// 11,516,727,739,532,2957,
// 11,516,727,739,532,2946,
// 11,515,727,739,532,2935,
// 11,515,727,739,532,2924,
// 11,515,727,739,532,2912,
// 11,515,727,739,532,2901,
// 11,514,735,739,533,2890,
// 11,514,747,743,533,2881,
// 11,514,750,749,533,2870,
// 11,514,751,753,533,2858,
// 11,514,751,758,533,2847,
// 11,514,756,759,533,2835,
// 11,514,758,762,533,2824,
// 11,514,758,763,533,2813,
// 11,514,758,763,533,2801,
// 11,514,758,763,533,2789,
// 11,514,758,763,533,2777,
// 11,514,758,763,533,2766,
// 11,514,758,763,533,2755,
// 11,514,758,763,533,2743,
// 11,514,758,763,533,2731,
// 11,514,758,763,533,2719,
// 11,514,758,763,533,2706,
// 11,514,758,763,533,2690,
// 11,514,758,763,533,2673,
// 11,514,758,763,533,2656,
// 11,514,758,763,533,2642,
// 11,514,758,763,533,2630,
// 11,514,758,763,533,2617,
// 11,514,758,763,533,2603,
// 11,515,758,763,533,2587,
// 11,515,761,764,533,2571,
// 11,515,764,766,533,2558,
// 11,515,769,767,533,2546,
// 11,515,774,768,533,2535,
// 11,515,778,768,533,2524,
// 11,515,784,772,533,2513,
// 11,515,784,773,533,2501,
// 11,515,784,773,533,2489,
// 11,515,784,773,533,2478,
// 11,514,784,773,533,2466,
// 11,514,784,773,533,2455,
// 11,514,784,773,533,2444,
// 11,514,784,773,533,2433,
// 11,514,784,773,532,2421,
// 11,514,784,773,532,2410,
// 11,514,778,773,532,2399,
// 11,514,774,773,532,2388,
// 11,514,774,768,531,2377,
// 11,514,774,755,532,2366,
// 11,515,774,744,533,2372,
// 11,515,762,738,533,2373,
// 11,515,753,727,533,2371,
// 11,514,753,720,544,2371,
// 11,515,751,706,551,2370,
// 11,515,747,694,562,2371,
// 11,514,734,680,572,2373,
// 11,514,721,667,579,2372,
// 11,514,713,652,583,2367,
// 11,514,705,640,586,2359,
// 11,514,697,628,589,2355,
// 11,514,685,618,589,2360,
// 11,514,676,606,593,2359,
// 11,514,674,595,598,2355,
// 11,514,674,584,601,2350,
// 11,514,674,579,602,2339,
// 11,514,666,568,602,2335,
// 11,514,652,562,603,2334,
// 11,514,637,554,605,2334,
// 11,513,628,542,610,2334,
// 11,513,626,531,612,2329,
// 11,513,618,520,613,2325,
// 11,513,611,509,617,2323,
// 11,512,611,498,621,2323,
// 11,512,600,487,621,2326,
// 11,511,599,476,630,2334,
// 11,511,590,465,631,2333,
// 11,510,580,454,631,2333,
// 11,511,571,443,631,2335,
// 11,511,560,433,631,2335,
// GRIPOPEN,510,555,425,631,2324,//gripper gripper
// GRIPOPEN,508,566,433,638,2325,
// GRIPOPEN,508,576,444,638,2330,
// GRIPOPEN,508,579,455,638,2338,
// GRIPOPEN,508,583,466,636,2341,
// GRIPOPEN,508,592,477,635,2340,
// GRIPOPEN,508,603,486,634,2337,
// GRIPOPEN,508,611,497,631,2337,
// GRIPOPEN,508,619,508,630,2337,
// GRIPOPEN,508,626,519,626,2338,
// GRIPOPEN,508,633,530,622,2340,
// GRIPOPEN,508,644,540,621,2341,
// GRIPOPEN,508,651,551,618,2344,
// GRIPOPEN,508,660,563,616,2349,
// GRIPOPEN,509,666,576,612,2355,
// GRIPOPEN,509,674,588,610,2362,
// GRIPOPEN,509,680,600,606,2365,
// GRIPOPEN,509,687,611,603,2371,
// GRIPOPEN,509,696,621,600,2382,
// GRIPOPEN,509,701,632,595,2393,
// GRIPOPEN,509,707,641,592,2405,
// GRIPOPEN,509,709,649,590,2417,
// GRIPOPEN,509,711,653,587,2430,
// GRIPOPEN,509,712,657,587,2444,
// GRIPOPEN,510,712,660,586,2458,
// GRIPOPEN,510,712,663,586,2475,
// GRIPOPEN,510,712,664,586,2492,
// GRIPOPEN,510,712,668,586,2511,
// GRIPOPEN,510,712,668,585,2528,
// GRIPOPEN,510,712,669,585,2546,
// GRIPOPEN,510,712,671,585,2560,
// GRIPOPEN,510,712,671,585,2577,
// GRIPOPEN,510,712,671,585,2596,
// GRIPOPEN,510,712,671,585,2614,
// GRIPOPEN,510,712,671,585,2632,
// GRIPOPEN,510,712,671,585,2649,
// GRIPOPEN,510,712,671,585,2665,
// GRIPOPEN,510,712,671,585,2682,
// GRIPOPEN,510,712,671,585,2700,
// GRIPOPEN,510,712,671,585,2718,
// GRIPOPEN,510,712,671,585,2737,
// GRIPOPEN,510,712,671,585,2758,
// GRIPOPEN,510,712,671,585,2777,
// GRIPOPEN,510,712,671,585,2794,
// GRIPOPEN,510,712,671,585,2810,
// GRIPOPEN,510,712,671,585,2826,
// GRIPOPEN,510,712,671,585,2840,
// GRIPOPEN,510,712,671,585,2853,
// GRIPOPEN,510,712,671,584,2867,
// GRIPOPEN,510,712,671,584,2880,
// GRIPOPEN,510,712,671,583,2893,
// GRIPOPEN,510,712,671,582,2907,
// GRIPOPEN,510,712,671,580,2922,
// GRIPOPEN,510,712,671,580,2939,
// GRIPOPEN,510,712,671,579,2954,
// GRIPOPEN,510,712,671,578,2968,
// GRIPOPEN,510,712,671,575,2983,
// GRIPOPEN,510,709,671,575,2996,
// GRIPOPEN,510,705,671,572,3007,
// GRIPOPEN,510,699,671,569,3018,
// GRIPOPEN,510,693,671,566,3029,
// GRIPOPEN,510,689,671,564,3040,
// GRIPOPEN,510,686,671,562,3052,
// GRIPOPEN,511,685,671,559,3063,
// GRIPOPEN,510,685,671,556,3074,
// GRIPOPEN,510,685,671,549,3085,
// GRIPOPEN,510,684,671,545,3097,
// GRIPOPEN,510,684,671,542,3108,
// GRIPOPEN,510,684,671,541,3119,
// GRIPOPEN,510,684,671,540,3130,
// GRIPOPEN,509,683,669,538,3141,
// GRIPOPEN,510,683,669,533,3152,
// GRIPOPEN,510,683,669,529,3163,
// GRIPOPEN,510,683,663,525,3174,
// GRIPOPEN,509,678,651,525,3171,
// GRIPOPEN,509,672,640,525,3169,
// GRIPOPEN,509,672,635,525,3180,
// GRIPOPEN,509,671,633,525,3191,
// GRIPOPEN,509,671,631,525,3202,
// GRIPOPEN,509,658,627,525,3204,
// GRIPOPEN,509,644,620,525,3204,
// GRIPOPEN,508,631,614,525,3203,
// GRIPOPEN,508,618,605,525,3202,
// GRIPOPEN,508,608,594,525,3202,
// GRIPOPEN,508,597,584,528,3206,
// GRIPOPEN,508,586,577,528,3206,
// GRIPOPEN,508,575,570,528,3206,
// GRIPOPEN,508,564,563,528,3207,
// GRIPOPEN,508,552,554,528,3207,
// GRIPOPEN,508,542,543,528,3209,
// GRIPOPEN,508,531,535,528,3210,
// GRIPOPEN,508,520,529,528,3208,
// GRIPOPEN,509,509,520,528,3207,
// GRIPOPEN,509,498,511,528,3207,
// GRIPOPEN,509,486,500,528,3202,
// GRIPOPEN,509,475,491,528,3203,
// GRIPOPEN,509,463,481,528,3210,
// GRIPOPEN,509,452,476,528,3208,
// GRIPOPEN,509,441,471,528,3207,
// GRIPOPEN,509,431,460,528,3207,
// GRIPOPEN,510,420,456,524,3214,
// GRIPOPEN,510,411,456,513,3214,
// GRIPOPEN,511,401,456,502,3214,
// GRIPOPEN,511,390,450,502,3215,
// GRIPOPEN,511,379,446,498,3213,
// GRIPOPEN,511,371,438,487,3213,
// GRIPOPEN,511,365,443,476,3213,
// GRIPOPEN,511,363,446,465,3217,
// GRIPOPEN,511,375,451,464,3217,
// GRIPOPEN,511,386,459,462,3217,
// GRIPOPEN,511,397,466,456,3219,
// GRIPOPEN,511,401,471,445,3222,
// GRIPOPEN,511,397,478,434,3221,
// GRIPOPEN,511,386,478,425,3220,
// GRIPOPEN,511,375,474,423,3219,
// GRIPOPEN,511,364,472,421,3219,
// GRIPOPEN,511,352,470,416,3219,//grippe
// 11,511,352,470,416,3219,//grippe
// GRIPOPEN,511,352,470,416,3219,//grippe
// 11,511,352,470,416,3219,//grippe
// GRIPOPEN,511,352,470,416,3219,//grippe
// 11,511,352,470,416,3219,//grippe
// GRIPOPEN,511,352,470,416,3219,//grippe
// 11,511,352,470,416,3219,//grippe
// GRIPOPEN,511,352,470,416,3219,//grippe
// GRIPOPEN,510,360,468,414,3214,
// GRIPOPEN,509,349,460,419,3216,
// GRIPOPEN,509,360,467,421,3207,
// GRIPOPEN,510,371,462,431,3208,
// GRIPOPEN,511,383,460,439,3207,
// GRIPOPEN,511,393,457,450,3206,
// GRIPOPEN,511,393,446,460,3207,
// GRIPOPEN,511,396,445,471,3206,
// GRIPOPEN,511,409,448,480,3204,
// GRIPOPEN,511,420,449,487,3202,
// GRIPOPEN,511,431,450,496,3201,
// GRIPOPEN,511,442,457,503,3196,
// GRIPOPEN,511,452,462,514,3193,
// GRIPOPEN,511,461,464,525,3190,
// GRIPOPEN,511,472,468,533,3191,
// GRIPOPEN,511,477,470,540,3180,
// GRIPOPEN,510,485,471,552,3176,
// GRIPOPEN,510,496,471,560,3172,
// GRIPOPEN,510,507,472,569,3167,
// GRIPOPEN,510,518,473,579,3162,
// GRIPOPEN,510,529,474,589,3155,
// GRIPOPEN,510,532,474,595,3144,
// GRIPOPEN,510,538,474,601,3133,
// GRIPOPEN,510,549,476,605,3130,
// GRIPOPEN,510,560,485,606,3121,
// GRIPOPEN,510,571,493,606,3114,
// GRIPOPEN,511,581,504,606,3109,
// GRIPOPEN,510,583,509,606,3098,
// GRIPOPEN,510,585,513,606,3087,
// GRIPOPEN,510,591,519,606,3076,
// GRIPOPEN,510,595,521,606,3065,
// GRIPOPEN,510,596,522,606,3053,
// GRIPOPEN,510,594,523,606,3042,
// GRIPOPEN,510,588,523,602,3031,
// GRIPOPEN,510,585,523,599,3020,
// GRIPOPEN,510,582,523,597,3009,
// GRIPOPEN,510,578,523,595,2998,
// GRIPOPEN,510,577,523,593,2987,
// GRIPOPEN,510,575,523,590,2976,
// GRIPOPEN,510,574,523,587,2964,
// GRIPOPEN,510,573,523,586,2953,
// GRIPOPEN,510,573,523,585,2942,
// GRIPOPEN,509,572,523,583,2931,
// GRIPOPEN,509,569,523,582,2920,
// GRIPOPEN,509,562,523,580,2909,
// GRIPOPEN,509,559,523,579,2898,
// GRIPOPEN,509,558,523,576,2887,
// GRIPOPEN,509,555,523,574,2876,
// GRIPOPEN,509,555,523,568,2865,
// GRIPOPEN,509,549,512,559,2858,
// GRIPOPEN,508,538,506,556,2853,
// GRIPOPEN,508,538,502,545,2861,
// GRIPOPEN,510,535,509,534,2863,//gripper
// 30,511,540,508,542,2874,
// 30,511,549,509,549,2885,
// 30,511,561,509,558,2896,
// 30,511,570,509,569,2905,
// 30,511,578,509,579,2916,
// 30,511,585,509,590,2922,
// 30,511,590,509,601,2927,
// 30,511,594,513,611,2938,
// 30,511,603,525,611,2944,
// 30,511,616,535,611,2951,
// 30,511,624,545,611,2962,
// 30,511,629,554,610,2974,
// 30,511,635,560,610,2985,
// 30,511,641,569,606,2996,
// 30,511,644,579,601,3008,
// 30,511,649,587,595,3020,
// 30,511,650,592,590,3032,
// 30,511,650,596,587,3043,
// 30,511,650,601,583,3054,
// 30,511,650,605,578,3066,
// 30,511,650,611,572,3078,
// 30,511,650,616,565,3090,
// 30,511,650,619,561,3101,
// 30,511,650,623,556,3113,
// 30,511,650,627,550,3124,
// 30,511,650,630,547,3135,
// 30,511,645,631,542,3146,
// 30,511,641,632,535,3157,
// 30,511,633,632,529,3168,
// 30,511,629,632,521,3179,
// 30,512,625,621,511,3180,
// 30,512,614,614,511,3180,
// 30,512,603,606,511,3178,
// 30,511,592,598,512,3175,
// 30,511,583,587,512,3169,
// 30,511,574,576,520,3168,
// 30,512,566,565,528,3173,
// 30,512,557,554,530,3175,
// 30,512,545,544,530,3174,
// 30,512,533,536,531,3174,
// 30,512,522,527,531,3176,
// 30,512,513,516,530,3177,
// 30,512,501,506,531,3178,
// 30,512,491,495,530,3181,
// 30,513,484,484,533,3185,
// 30,513,476,473,539,3188,
// 30,514,465,462,541,3194,
// 30,514,454,456,541,3197,
// 30,515,443,450,540,3199,
// 30,515,432,448,536,3203,
// 30,515,421,447,530,3205,
// 30,515,410,447,523,3204,
// 30,515,402,447,512,3206,
// 30,515,394,447,501,3210,
// 30,516,385,447,490,3211,
// 30,516,377,448,479,3214,
// 30,517,371,451,468,3214,
// 30,516,380,462,465,3212,
// 30,517,391,468,456,3211,
// 30,517,402,473,454,3210,
// 30,516,413,480,451,3206,
// 30,516,412,482,440,3208,
// 30,516,401,481,433,3209,
// 30,516,390,479,429,3211,
// 30,516,379,474,424,3210,
// 30,517,367,469,423,3211,
// 30,518,356,466,421,3213,
// 30,516,345,465,419,3213,//gro
// 500,516,345,465,419,3213,//gro
// 500,514,357,464,419,3215,
// 500,509,345,463,419,3215,
// 500,507,350,461,430,3207,
// 500,507,364,460,436,3205,
// 500,507,379,459,447,3204,
// 500,507,395,459,458,3199,
// 500,507,409,461,473,3193,
// 500,507,420,464,484,3190,
// 500,507,431,468,492,3191,
// 500,507,442,471,498,3191,
// 500,506,452,483,501,3184,
// 500,506,460,491,502,3173,
// 500,506,472,497,508,3171,
// 500,506,484,503,514,3171,
// 500,506,498,509,519,3169,
// 500,506,509,514,525,3170,
// 500,506,522,520,531,3170,
// 500,506,535,522,534,3170,
// 500,506,546,526,544,3164,
// 500,506,549,526,547,3153,
// 500,506,556,526,553,3142,
// 500,506,562,526,560,3130,
// 500,506,569,526,564,3118,
// 500,506,578,526,570,3107,
// 500,507,590,526,576,3099,
// 500,507,602,526,581,3093,
// 500,507,616,526,589,3086,
// 500,507,627,526,596,3075,
// 500,507,638,526,604,3065,
// 500,507,644,526,610,3054,
// 500,507,655,526,610,3045,
// 500,507,666,526,619,3038,
// 500,507,670,526,622,3027,
// 500,507,675,525,628,3016,
// 500,507,679,523,631,3005,
// 500,507,680,520,635,2994,
// 500,507,680,513,641,2983,
// 500,507,677,502,646,2974,
// 500,507,671,489,651,2969,
// 500,507,663,478,660,2968,
// 500,507,652,466,666,2966,
// 500,507,641,455,671,2959,
// 500,507,631,444,676,2950,
// 500,507,625,433,678,2939,
// 500,508,614,424,678,2931,
// 500,508,603,417,678,2928,
// 500,508,592,410,678,2923,
// 500,508,580,403,678,2920,
// 500,508,568,396,678,2918,
// 500,508,557,387,678,2917,
// 500,508,546,377,678,2915,
// 500,508,534,370,678,2914,
// 500,509,525,359,678,2914,
// 500,509,514,349,678,2914,
// 500,509,502,340,678,2913,
// 500,509,491,335,678,2912,
// 500,509,480,331,677,2911,
// 500,509,469,326,674,2907,
// 500,509,457,320,670,2902,
// 500,509,445,312,663,2902,
// 500,509,432,304,658,2900,
// 500,509,419,301,651,2900,
// 500,509,406,296,646,2899,
// 500,510,398,293,634,2895,
// 500,508,393,292,622,2895,
// 500,509,389,292,611,2893,
// 500,509,378,292,602,2893,
// 500,509,367,292,594,2894,
// 500,509,355,292,583,2892,
// 500,509,344,292,574,2892,
// 500,509,332,291,564,2890,
// 500,509,322,290,552,2889,
// 500,509,311,289,543,2888,
// 500,509,300,289,533,2887,
// 500,509,290,289,521,2887,
// 500,509,279,289,510,2887,
// 500,509,267,289,501,2887,
// 500,509,256,289,491,2887,
// 500,509,245,289,482,2887,
// 500,509,234,291,472,2888,
// 500,509,230,292,461,2889,
// 500,509,227,301,450,2887,
// 500,508,223,310,439,2885,
// 500,508,219,322,430,2884,
// 500,508,213,327,419,2882,
// 500,508,204,330,408,2882,
// 500,508,192,330,400,2882,
// 500,508,182,330,388,2881,
// 500,509,175,330,384,2870,
// 500,508,172,333,372,2872,
// 500,508,161,340,364,2872,
// 500,508,154,347,353,2871,
// 500,508,149,358,344,2869,
// 500,508,148,370,333,2869,
// 500,508,146,378,321,2866,
// 500,508,144,387,310,2868,
// 500,508,141,397,298,2865,
// 500,507,137,403,287,2858,







// };
uint16_t profile3[]=
{
  499,515,146,411,279,2869,
499,514,142,401,290,2872,
499,514,144,390,298,2878,
499,514,144,378,303,2885,
499,514,141,367,313,2884,
499,515,141,359,325,2887,
499,515,141,349,336,2895,
499,515,144,345,347,2898,
499,515,148,342,358,2902,
499,515,158,342,369,2906,
499,515,169,341,377,2910,
499,515,180,341,387,2912,
499,515,191,341,397,2917,
499,515,201,341,408,2922,
499,515,212,340,417,2926,
499,515,221,333,429,2931,
499,515,230,330,440,2933,
499,515,240,326,451,2942,
499,515,247,322,462,2947,
499,515,252,315,473,2948,
499,515,260,309,484,2952,
499,515,269,303,496,2959,
499,515,280,303,506,2963,
499,515,290,303,517,2970,
499,515,301,303,528,2981,
499,515,312,303,536,2992,
498,515,324,303,547,3003,
499,515,336,303,559,3011,
499,515,345,303,570,3021,
499,515,358,303,579,3031,
499,515,367,304,587,3044,
499,515,378,308,594,3058,
499,515,387,309,601,3069,
499,515,398,312,607,3079,
499,515,409,318,610,3089,
499,515,420,323,613,3099,
499,515,428,327,616,3110,
499,515,438,332,616,3121,
499,515,444,340,616,3132,
498,515,446,345,616,3143,
499,515,446,349,616,3156,
499,515,448,353,614,3168,
499,515,448,356,613,3181,
499,515,448,360,612,3192,
499,515,448,363,610,3203,
499,515,448,369,610,3214,
499,515,448,375,605,3226,
498,515,448,383,597,3237,
499,515,448,394,586,3243,
499,515,448,403,575,3245,
499,515,448,414,565,3245,
498,515,448,422,552,3246,
499,515,448,435,541,3245,
498,515,449,445,530,3241,
499,515,449,456,524,3240,
499,515,454,467,518,3233,
499,515,462,478,515,3238,
499,515,463,481,507,3227,
499,515,463,484,501,3216,
499,515,459,486,498,3205,
499,515,449,486,487,3205,
499,515,437,486,477,3208,
499,515,427,486,466,3209,
499,515,425,484,455,3208,
499,515,416,484,443,3209,
499,515,405,484,436,3209,
499,515,396,484,425,3210,
499,515,385,482,420,3211,
499,515,374,478,416,3214,//grip
5,515,374,478,416,3214,//grip
5,508,388,481,416,3222,
5,506,400,487,420,3223,
5,506,411,487,423,3224,
5,506,422,489,427,3225,
5,506,435,495,430,3222,
5,506,446,497,435,3221,
5,507,457,503,439,3218,
5,507,468,508,439,3217,
5,507,479,508,446,3219,
5,507,490,517,450,3219,
5,507,501,523,450,3218,
5,507,505,534,451,3223,
5,507,514,537,462,3222,
5,507,519,540,473,3226,
5,507,530,549,478,3226,
5,507,541,558,488,3230,
5,507,552,567,495,3231,
5,507,563,575,502,3229,
5,506,575,584,509,3222,
5,506,585,593,514,3210,
5,506,596,601,518,3204,
5,506,608,609,523,3202,
5,506,619,614,528,3201,
5,506,631,619,530,3199,
5,506,642,623,534,3193,
5,506,653,628,540,3182,
5,506,661,630,543,3171,
5,506,664,631,545,3159,
5,506,667,633,547,3144,
5,506,670,637,548,3129,
5,506,674,640,548,3115,
5,506,676,644,549,3102,
5,505,680,647,550,3090,
5,505,685,651,552,3078,
5,504,688,653,555,3066,
5,504,691,656,556,3055,
5,503,693,660,559,3044,
5,502,699,660,564,3033,
5,502,705,660,569,3022,
5,502,705,660,573,3003,
5,502,705,661,575,2982,
5,502,705,661,577,2962,
5,502,704,661,578,2944,
5,502,704,661,578,2922,
5,502,704,661,579,2894,
5,502,704,661,580,2869,
5,502,704,661,582,2851,
5,502,704,662,584,2834,
5,502,704,663,585,2820,
5,502,705,663,585,2806,
5,502,705,663,586,2793,
5,502,705,663,587,2776,
5,502,704,663,589,2756,
5,502,705,663,589,2740,
5,502,705,663,589,2727,
5,502,705,663,589,2715,
5,502,704,663,589,2703,
5,502,704,663,589,2688,
5,502,705,662,590,2673,
5,502,705,661,590,2657,
5,502,705,660,590,2640,
5,503,705,660,593,2624,
5,503,704,657,594,2608,
5,504,705,654,596,2595,
5,504,705,653,597,2583,
5,504,705,653,599,2572,
5,504,704,653,601,2561,
5,504,705,653,601,2550,
5,504,703,653,601,2539,
5,504,701,653,601,2528,
5,503,699,653,600,2516,
5,503,699,653,601,2504,
5,503,699,653,601,2491,
5,503,699,653,601,2480,
5,503,699,651,601,2469,
5,503,697,648,600,2457,
5,503,694,642,601,2446,
5,502,689,637,601,2435,
5,502,689,637,601,2423,
5,502,691,637,600,2412,
5,502,699,635,597,2401,
5,502,699,627,597,2390,
5,502,699,620,597,2379,
5,502,699,609,597,2373,
5,502,688,601,597,2371,
5,502,677,593,597,2371,
5,502,666,584,599,2372,
5,502,655,573,604,2373,
5,502,653,562,607,2365,
5,502,653,551,607,2361,
5,502,646,540,612,2363,
5,502,635,531,616,2362,
5,503,626,520,617,2361,
5,502,626,509,617,2354,
5,502,617,498,617,2351,
5,502,613,487,617,2350,
5,502,602,482,617,2349,
5,502,590,476,617,2348,
5,502,583,465,618,2348,
5,502,577,454,628,2348,
5,502,566,445,629,2349,
5,502,555,436,630,2350,
5,500,546,425,630,2348,
5,500,543,416,641,2351,
5,498,532,411,642,2350,//grip
GRIPOPEN,498,543,416,642,2354,
GRIPOPEN,498,555,429,642,2353,
GRIPOPEN,498,566,438,642,2353,
GRIPOPEN,498,573,449,642,2356,
GRIPOPEN,498,579,460,642,2358,
GRIPOPEN,498,585,472,642,2360,
GRIPOPEN,498,589,483,642,2362,
GRIPOPEN,498,596,494,642,2364,
GRIPOPEN,498,600,506,642,2369,
GRIPOPEN,498,609,518,641,2376,
GRIPOPEN,498,621,526,641,2382,
GRIPOPEN,498,630,537,641,2391,
GRIPOPEN,498,638,546,641,2402,
GRIPOPEN,498,642,554,641,2413,
GRIPOPEN,500,644,559,641,2424,
GRIPOPEN,500,646,562,641,2436,
GRIPOPEN,500,646,564,641,2447,
GRIPOPEN,500,646,567,641,2459,
GRIPOPEN,500,646,568,641,2474,
GRIPOPEN,500,646,568,641,2488,
GRIPOPEN,500,646,568,641,2504,
GRIPOPEN,500,646,568,641,2517,
GRIPOPEN,498,646,568,641,2531,
GRIPOPEN,498,644,568,641,2545,
GRIPOPEN,498,644,568,641,2560,
GRIPOPEN,498,643,568,641,2573,
GRIPOPEN,498,641,568,641,2586,
GRIPOPEN,498,641,568,641,2599,
GRIPOPEN,500,641,568,641,2613,
GRIPOPEN,500,641,568,641,2627,
GRIPOPEN,500,641,568,641,2640,
GRIPOPEN,501,639,568,641,2655,
GRIPOPEN,501,638,568,641,2670,
GRIPOPEN,501,638,568,641,2684,
GRIPOPEN,501,638,568,641,2698,
GRIPOPEN,501,638,568,641,2709,
GRIPOPEN,501,638,568,641,2720,
GRIPOPEN,501,639,568,641,2734,
GRIPOPEN,501,641,568,641,2753,
GRIPOPEN,501,641,568,641,2770,
GRIPOPEN,501,641,568,641,2785,
GRIPOPEN,501,642,568,641,2800,
GRIPOPEN,501,642,568,639,2818,
GRIPOPEN,502,642,568,634,2835,
GRIPOPEN,502,642,568,631,2849,
GRIPOPEN,502,641,568,627,2861,
GRIPOPEN,502,639,568,622,2873,
GRIPOPEN,502,636,568,620,2886,
GRIPOPEN,502,636,569,618,2901,
GRIPOPEN,502,636,569,616,2915,
GRIPOPEN,502,636,570,613,2927,
GRIPOPEN,502,636,570,610,2939,
GRIPOPEN,502,636,571,609,2951,
GRIPOPEN,502,635,571,606,2963,
GRIPOPEN,502,635,571,603,2975,
GRIPOPEN,502,633,571,602,2989,
GRIPOPEN,502,631,571,600,3000,
GRIPOPEN,502,627,571,596,3013,
GRIPOPEN,501,622,571,593,3025,
GRIPOPEN,501,621,570,590,3036,
GRIPOPEN,501,619,570,587,3048,
GRIPOPEN,501,619,569,587,3061,
GRIPOPEN,501,619,568,587,3072,
GRIPOPEN,502,618,567,587,3084,
GRIPOPEN,501,616,565,587,3096,
GRIPOPEN,502,613,563,586,3107,
GRIPOPEN,501,608,561,583,3118,
GRIPOPEN,501,606,560,579,3129,
GRIPOPEN,501,603,560,573,3140,
GRIPOPEN,501,500,560,565,3151,
GRIPOPEN,501,500,560,559,3157,
GRIPOPEN,501,500,560,550,3164,
GRIPOPEN,501,500,560,543,3175,
GRIPOPEN,502,500,561,533,3186,
GRIPOPEN,503,500,564,525,3197,
GRIPOPEN,506,500,569,514,3207,
GRIPOPEN,510,500,573,503,3212,
GRIPOPEN,515,500,573,492,3215,
GRIPOPEN,519,500,567,484,3209,
GRIPOPEN,521,500,560,482,3209,
GRIPOPEN,524,500,549,479,3206,
GRIPOPEN,526,500,540,478,3208,
GRIPOPEN,528,500,532,476,3209,
GRIPOPEN,529,489,527,474,3211,
GRIPOPEN,530,478,520,473,3211,
GRIPOPEN,530,467,513,468,3210,
GRIPOPEN,530,456,509,464,3209,
GRIPOPEN,531,445,501,456,3209,
GRIPOPEN,532,434,492,454,3209,
GRIPOPEN,533,423,489,450,3209,
GRIPOPEN,536,413,488,439,3205,
GRIPOPEN,539,402,481,435,3207,
GRIPOPEN,538,391,479,426,3209,
GRIPOPEN,538,380,478,421,3211,
GRIPOPEN,537,368,472,420,3211,//grip
5,537,368,472,420,3211,//grip
GRIPOPEN,537,368,472,420,3211,//grip
5,537,368,472,420,3211,//grip
GRIPOPEN,537,368,472,420,3211,//grip
5,537,368,472,420,3211,//grip
GRIPOPEN,537,368,472,420,3211,//grip
5,537,368,472,420,3211,//grip
GRIPOPEN,537,368,472,420,3211,//grip
5,537,368,472,420,3211,//grip
GRIPOPEN,537,368,472,420,3211,//grip
5,537,368,472,420,3211,//grip
GRIPOPEN,537,368,472,420,3211,//grip
5,537,368,472,420,3211,//grip
GRIPOPEN,537,368,472,420,3211,//grip
5,537,368,472,420,3211,//grip
GRIPOPEN,537,368,472,420,3211,//grip
5,537,368,472,420,3211,//grip
GRIPOPEN,537,368,472,420,3211,//grip
GRIPOPEN,537,368,472,420,3211,//grip
GRIPOPEN,529,378,477,416,3212,
GRIPOPEN,529,389,483,420,3206,
GRIPOPEN,529,401,483,431,3206,
GRIPOPEN,529,412,487,433,3209,
GRIPOPEN,530,423,495,436,3209,
GRIPOPEN,530,435,498,442,3207,
GRIPOPEN,530,446,501,448,3207,
GRIPOPEN,531,457,509,449,3208,
GRIPOPEN,532,468,517,450,3207,
GRIPOPEN,533,479,526,451,3211,
GRIPOPEN,532,490,534,455,3210,
GRIPOPEN,532,501,543,456,3209,
GRIPOPEN,531,509,545,467,3206,
GRIPOPEN,531,520,551,475,3206,
GRIPOPEN,531,531,557,479,3203,
GRIPOPEN,531,542,567,482,3199,
GRIPOPEN,531,555,577,483,3198,
GRIPOPEN,531,566,588,483,3194,
GRIPOPEN,531,578,597,484,3190,
GRIPOPEN,531,588,608,484,3190,
GRIPOPEN,531,599,617,484,3190,
GRIPOPEN,530,610,626,484,3189,
GRIPOPEN,531,621,633,484,3188,
GRIPOPEN,530,631,644,484,3186,
GRIPOPEN,530,641,656,484,3182,
GRIPOPEN,530,650,667,484,3178,
GRIPOPEN,530,662,677,484,3174,
GRIPOPEN,530,672,688,484,3166,
GRIPOPEN,530,678,697,484,3154,
GRIPOPEN,530,689,707,485,3143,
GRIPOPEN,530,697,711,488,3131,
GRIPOPEN,530,702,712,490,3120,
GRIPOPEN,530,707,712,492,3109,
GRIPOPEN,530,710,712,494,3098,
GRIPOPEN,530,712,712,496,3083,
GRIPOPEN,530,714,712,497,3070,
GRIPOPEN,530,718,712,499,3056,
GRIPOPEN,530,722,712,501,3041,
GRIPOPEN,530,724,712,501,3024,
GRIPOPEN,530,725,712,501,3010,
GRIPOPEN,530,727,712,501,2999,
GRIPOPEN,530,729,712,501,2988,
GRIPOPEN,530,729,712,501,2977,
GRIPOPEN,530,729,712,501,2962,
GRIPOPEN,530,729,712,501,2951,
GRIPOPEN,530,729,712,501,2940,
GRIPOPEN,530,729,712,501,2929,
GRIPOPEN,530,731,712,501,2918,
GRIPOPEN,530,729,700,503,2913,
GRIPOPEN,530,724,688,510,2909,
GRIPOPEN,530,718,677,517,2907,
GRIPOPEN,530,708,666,519,2905,
GRIPOPEN,530,697,654,521,2903,
GRIPOPEN,530,685,644,524,2900,
GRIPOPEN,530,675,631,528,2894,
GRIPOPEN,530,674,620,531,2892,
GRIPOPEN,530,674,609,538,2892,
GRIPOPEN,529,674,598,544,2891,
GRIPOPEN,530,671,586,553,2887,
GRIPOPEN,529,671,578,564,2885,
GRIPOPEN,530,671,567,574,2881,
GRIPOPEN,530,671,556,582,2880,
GRIPOPEN,530,671,545,590,2879,
GRIPOPEN,530,660,536,595,2879,
GRIPOPEN,530,645,530,596,2878,
GRIPOPEN,529,631,520,597,2876,
GRIPOPEN,529,618,509,599,2874,
GRIPOPEN,529,605,497,600,2872,
GRIPOPEN,529,594,488,601,2871,
GRIPOPEN,529,583,477,602,2872,
GRIPOPEN,529,571,469,602,2871,
GRIPOPEN,529,560,468,602,2873,
GRIPOPEN,528,549,465,602,2872,
GRIPOPEN,528,538,460,602,2872,
GRIPOPEN,528,527,455,602,2872,
GRIPOPEN,528,516,448,602,2870,
GRIPOPEN,527,505,443,602,2869,
GRIPOPEN,525,494,438,602,2871,
GRIPOPEN,525,483,438,598,2880,
GRIPOPEN,524,472,435,593,2878,
GRIPOPEN,525,461,435,587,2877,
GRIPOPEN,524,452,433,576,2874,
GRIPOPEN,524,445,433,565,2876,
GRIPOPEN,526,434,433,556,2879,
GRIPOPEN,524,423,435,546,2874,
GRIPOPEN,524,422,444,535,2869,
GRIPOPEN,524,422,455,528,2862,
GRIPOPEN,524,412,457,517,2860,//
30,524,423,457,514,2855,
30,524,422,453,517,2866,
30,524,432,453,528,2870,
30,524,444,453,534,2879,
30,524,453,453,542,2891,
30,524,462,454,549,2903,
30,524,470,456,556,2915,
30,524,477,457,563,2926,
30,524,484,458,565,2938,
30,524,494,462,570,2949,
30,524,506,467,574,2960,
30,524,514,471,577,2972,
30,524,523,476,579,2987,
30,524,531,482,579,3000,
30,524,539,487,579,3011,
30,525,545,493,579,3024,
30,524,555,498,579,3040,
30,524,558,506,579,3057,
30,524,565,511,579,3072,
30,524,571,517,579,3085,
30,524,578,521,579,3101,
30,524,586,526,579,3118,
30,524,592,532,579,3135,
30,525,598,535,579,3153,
30,525,604,540,578,3167,
30,525,609,545,576,3178,
30,525,616,551,574,3190,
30,525,618,555,572,3201,
30,525,618,556,569,3212,
30,525,618,556,565,3224,
30,525,617,556,564,3235,
30,526,613,556,560,3246,
30,526,610,556,556,3259,
30,526,470,556,520,3270,
30,525,470,556,520,3260,
30,525,470,556,520,3257,
30,525,470,554,520,3248,
30,525,470,544,520,3243,
30,525,470,535,520,3245,
30,525,470,526,520,3245,
30,524,470,523,519,3234,
30,524,470,523,508,3232,
30,524,470,523,498,3228,
30,525,470,523,491,3228,
30,524,470,521,488,3229,
30,525,470,517,486,3227,
30,524,470,510,484,3226,
30,524,459,506,484,3227,
30,524,448,502,478,3217,
30,524,437,492,474,3218,
30,524,426,488,466,3214,
30,524,419,488,455,3213,
30,523,412,488,443,3210,
30,525,404,483,432,3210,
30,525,393,483,424,3211,
30,525,382,478,421,3213,//
500,514,368,476,411,3222,
500,514,379,474,420,3220,
500,514,390,473,430,3212,
500,514,401,472,440,3205,
500,514,411,470,452,3196,
500,513,421,469,463,3189,
500,513,432,467,474,3184,
500,512,443,463,484,3179,
500,511,452,461,496,3175,
500,511,461,458,508,3171,
500,510,469,454,520,3168,
500,509,476,450,532,3163,
500,508,485,445,543,3157,
500,507,490,441,555,3149,
500,507,493,436,568,3139,
500,505,497,432,579,3128,
500,504,499,429,589,3117,
500,503,502,425,597,3104,
500,502,505,422,605,3090,
500,501,506,417,610,3073,
500,500,507,415,616,3058,
500,498,507,411,619,3044,
500,497,507,406,622,3031,
500,496,507,403,624,3019,
500,495,503,397,626,3008,
500,495,493,391,626,2997,
500,494,482,385,626,2989,
500,493,467,378,626,2982,
500,492,451,372,626,2977,
500,492,439,361,626,2973,
500,492,427,351,625,2970,
500,492,422,340,624,2966,
500,493,413,330,624,2955,
500,493,402,323,622,2945,
500,493,390,317,621,2935,
500,494,379,309,614,2924,
500,494,367,302,610,2918,
500,495,356,295,604,2912,
500,495,350,293,601,2900,
500,495,343,292,597,2888,
500,495,337,293,594,2877,
500,494,333,293,583,2865,
500,494,333,292,574,2854,
500,494,333,292,563,2847,
500,494,333,292,552,2847,
500,494,333,293,541,2842,
500,494,324,292,532,2831,
500,494,316,292,529,2819,
500,494,309,292,524,2808,
500,494,302,292,518,2797,
500,493,298,292,510,2786,
500,493,295,293,501,2775,
500,493,290,304,488,2769,
500,493,281,315,479,2770,
500,493,273,323,468,2771,
500,493,272,324,457,2775,
500,494,265,325,446,2779,
500,494,261,325,435,2780,
500,494,257,325,424,2778,
500,494,253,325,414,2767,
500,494,250,325,403,2764,
500,494,245,328,392,2765,
500,494,241,334,378,2773,
500,495,237,345,370,2782,
500,495,233,356,360,2789,
500,495,230,367,353,2796,
500,495,219,375,344,2801,
500,496,212,378,333,2805,
500,498,206,378,326,2816,
500,500,195,378,320,2825,
500,500,184,378,315,2827,
500,500,177,378,310,2838,
500,501,166,377,305,2840,
500,501,155,375,301,2841,
500,501,144,374,295,2841,
500,503,137,374,289,2852,
500,507,137,374,289,2863,







};
void curPos_cb(const std_msgs::UInt16MultiArray::ConstPtr& array);
// void goalPos_cb(const std_msgs::UInt16MultiArray::ConstPtr& array);
void armProfile_cb(const std_msgs::UInt16::ConstPtr& idx);
void drillState_cb(const std_msgs::UInt8::ConstPtr& state);
// void servoState_cb(const std_msgs::UInt8::ConstPtr& state);
void mainTasks();
void runArm();
bool readyToAdvance();
void runArmState();


uint16_t curPos[6] = {0,0,0,0,0,0};
uint16_t goalPos[6] = {0,0,0,0,0,0};
uint16_t armProfile_idx = 0;
uint16_t step = 0;
uint8_t drillState = 0;
uint8_t servoState = 0;
bool profileInited = false;
bool profile2Inited = false;
bool profile3Inited = false;
bool profile4Inited = false;
bool profileCompleted = false;

std_msgs::UInt16MultiArray goalPos_ros;
std_msgs::Bool armState_ros;

int main(int argc, char **argv)
{
  ros::init(argc, argv, "handler");
  /* start cyclic part */
  ros::NodeHandle n;
  ros::Publisher goalPos_pub = n.advertise<std_msgs::UInt16MultiArray>("armGoalPos", 100);
  ros::Publisher armState_pub = n.advertise<std_msgs::Bool>("armState",100);
  ros::Subscriber curPos_sub = n.subscribe("armCurPos", 100, curPos_cb);
  ros::Subscriber armProfile_sub = n.subscribe("armProfile_idx", 100, armProfile_cb);
  ros::Subscriber drillState_sub = n.subscribe("drillState", 100, drillState_cb);
  // ros::Subscriber servoState_sub = n.subscribe("servoState", 100, servoState_cb);
  // ros::Subscriber goalPos_sub = n.subscribe("dxlGoalPos", 100, goalPos_cb);

  ros::Rate loop_rate(100);

  // command_ros.data = 'p';


  while(ros::ok())
  {
    mainTasks();
    //command_pub.publish(command_ros);
    goalPos_pub.publish(goalPos_ros);
    armState_pub.publish(armState_ros);
    ros::spinOnce();
    loop_rate.sleep();
  }
  return 0;
}
void mainTasks()
{
  runArmState();
  goalPos_ros.data.clear();
  for (int i = 0; i < 6; i++)
  {
    goalPos_ros.data.push_back(goalPos[i]);
  }

}
void runArmState()
{
  switch(armProfile_idx)
  {
    case 0:
      step = 0;
      profileInited = false;
      armState_ros.data = false;
    break;
    case 1:
      // ROS_INFO("running profile 1");
      if(step < PROFILE1LENGTH)
      {
        if(!profileInited)
        {
          for (int i = 0; i < 6; i++)
          {
            goalPos[i] = profile1[i];
            profileInited = true;
          }
        }
        if(readyToAdvance())
        {

          // ROS_INFO("advanced to next step");

          for (int i = 0; i < 6; i++)
          {
            goalPos[i] = profile1[(i)+step*6];
          }
          
          step++;
        }
      }
      else
      {
        for (int i = 0; i < 6; i++)
        {
          goalPos[i] = 0;
        }
        armState_ros.data = true;
        // armProfile_idx = 0;
      }
    break;
    case 2:
      // ROS_INFO("running profile 2");
      if(step < PROFILE2LENGTH)
      {
        if(!profileInited)
        {
          for (int i = 0; i < 6; i++)
          {
            goalPos[i] = profile2[i];
            profileInited = true;
          }
        }
        if(readyToAdvance())
        {

          //  ROS_INFO("advanced to next step");

          for (int i = 0; i < 6; i++)
          {
            goalPos[i] = profile2[(i)+step*6];
          }
          ROS_INFO("running step: %d", step);
          step++;
        }
      }
      else
      {
        for (int i = 0; i < 6; i++)
        {
          goalPos[i] = 0;
        }
        armState_ros.data = true;
        // armProfile_idx = 0;
      }
    break;
    case 3:
      // ROS_INFO("Case 3");

      if(step < PROFILE3LENGTH)
      {
        if(!profileInited)
        {
          for (int i = 0; i < 6; i++)
          {
            goalPos[i] = profile3[i];
            profileInited = true;
          }
        }
        if(readyToAdvance())
        {
          // ROS_INFO("advanced to next step");

          for (int i = 0; i < 6; i++)
          {
            goalPos[i] = profile3[(i)+step*6];
          }
          ROS_INFO("current step: %d", step);
          step++;
        }
      }
      else
      {
        for (int i = 0; i < 6; i++)
        {
          goalPos[i] = 0;
        }
        armState_ros.data = true;
        // armProfile_idx = 0;
      }
    break;
  }
}
void runArm()
{
  // ROS_INFO("profile: %d", armProfile_idx);
  if (armProfile_idx == 0)
  {
    for (int i = 0; i < 6; i++)
    {
      goalPos[i] = 0;
    }
  }
  else if (armProfile_idx == 1)
  {
    if(profileInited && !profileCompleted)
    {

      if(step < PROFILE1LENGTH)
      {
        if(readyToAdvance())
        {
          // ROS_INFO("advanced to next step");
          step++;
          for (int i = 0; i < 6; i++)
          {
            goalPos[i] = profile1[(i)+step*6];
          }
        }
      }
      else
      {
        for (int i = 0; i < 6; i++)
        {
          goalPos[i] = 0;
        }
        profileCompleted = true;
        profileInited = false;
      }
    }
    else
    {
      step = 0;
      for (int i = 0; i < 6; i++)
      {
        goalPos[i] = profile1[(i)];
      }
      profileInited = true;
      profileCompleted = false;
    }
  }
  else if (armProfile_idx == 2)
  {
    if(profile2Inited)
    {

      if(step < PROFILE2LENGTH)
      {
        if(readyToAdvance())
        {
          // ROS_INFO("advanced to next step");
          step++;
          for (int i = 0; i < 6; i++)
          {
            goalPos[i] = profile2[(i)+step*6];
          }
        }
      }
      else
      {
        for (int i = 0; i < 6; i++)
        {
          goalPos[i] = 0;
        }
      }
    }
    else
    {
      step = 0;
      for (int i = 0; i < 6; i++)
      {
        goalPos[i] = profile2[i];
      }
      profile2Inited = true;
    }
  }
  else if (armProfile_idx ==3)
  {

      if(profile3Inited)
      {

        if(step < PROFILE3LENGTH)
        {
          if(readyToAdvance())
          {
            // ROS_INFO("advanced to next step");
            step++;
            for (int i = 0; i < 6; i++)
            {
              goalPos[i] = profile3[(i)+step*6];
            }
          }
        }
        else
        {
          for (int i = 0; i < 6; i++)
          {
            goalPos[i] = 0;
          }
        }
      }
      else
      {
        step = 0;
        for (int i = 0; i < 6; i++)
        {
          goalPos[i] = profile3[i];
        }
        profile3Inited = true;
      }
    }
  // else if (armProfile_idx ==4)
  // {

  //     if(profile4Inited)
  //     {

  //       if(step < PROFILE4LENGTH)
  //       {
  //         if(readyToAdvance())
  //         {
  //           // ROS_INFO("advanced to next step");
  //           step++;
  //           for (int i = 0; i < 6; i++)
  //           {
  //             goalPos[i] = profile4[(i)+step*6];
  //           }
  //         }
  //       }
  //       else
  //       {
  //         for (int i = 0; i < 6; i++)
  //         {
  //           goalPos[i] = 0;
  //         }
  //       }
  //     }
  //     else
  //     {
  //       step = 0;
  //       for (int i = 0; i < 6; i++)
  //       {
  //         goalPos[i] = profile4[i];
  //       }
  //       profile4Inited = true;
  //     }
  //   }
}
bool readyToAdvance()
{
  for (int i = 0; i < 6; i++)
  {
    int error = abs(curPos[i] - goalPos[i]);
    // ROS_INFO("error: %d", error);
    // ROS_INFO("curpos4: %d", curPos[4]);
    if (error > MOTIONTH)
    {
      return 0;
    }
  }
  return 1;
}
void curPos_cb(const std_msgs::UInt16MultiArray::ConstPtr& array)
{
  for (int i = 0; i < 6; i++)
  {
    curPos[i] = (uint16_t)(array->data[i]);
  }
}
void armProfile_cb(const std_msgs::UInt16::ConstPtr& idx)
{
  armProfile_idx = idx->data;
  ROS_INFO("armProfile: %d", armProfile_idx);
}
void drillState_cb(const std_msgs::UInt8::ConstPtr& state)
{
  drillState = state->data;
  ROS_INFO("drillState: %d", drillState);
}
// void servoState_cb(const std_msgs::UInt8::ConstPtr& state)
// {
//   servoState = state->data;
//   ROS_INFO("servoState: %d", servoState);
// }
// void goalPos_cb(const std_msgs::UInt16MultiArray::ConstPtr& array)
// {
//   for (int i = 0; i < 4; i++)
//   {
//     goalPos[i] = (uint16_t)array->data[i];
//   }
// }
